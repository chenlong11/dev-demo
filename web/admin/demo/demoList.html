<html>
<head>
    <title>列表</title>
[#include "/admin/include/adminHeader.html"/]
</head>
<body>
<h1>Demo List</h1>

<div>
    <form id="search">

    </form>
    <a href="javascript:edit()">添加</a>
</div>
<div id="table"></div>

[#include "/admin/include/adminScript.html"/]
<script>

    $(function () {
        query();
    })

    function edit(id) {
        id = id || '';
        openDialog({
            url: '${ctx}/admin/demo/edit/' + id,
            params: {},//非必传参数
            btn: ['确定', '关闭'],
            yes: function (index, layero) {
                $('#form').submit();
            }
        });
    }

    function query() {
        var param = $("#search").serializeObject();
        var options = {
            id: "table",
            //class: "",  table的class 可不传
            url: "${ctx}/admin/demo/list.html",
            param: param,
            pageSize: 5,
            columns: [
                {field: 'id', title: 'ID', width: "33%"},
                {field: 'demoString', title: 'DEMO_STRING', width: "20%"},
                {
                    title: '操作', width: "33%", customize: function (index, item) {
                        var htmlstr = '<a href="javascript:edit(\'' + item.id + '\')">修改</a>  '
                            + '<a href="javascript:del(\'' + item.id + '\')">删除</a>';
                        return htmlstr;
                    }
                }
            ]
        };
        paging(options);
    }

    function del(id) {
        $.post('${ctx}/admin/demo/del/'+id,{},function (data) {
            console.log('data', data);
            if(data.status!=1) {
                errMsg();
            }
            sucessMsg(function () {
                query();
            });
        },'json');
    }
</script>
</body>
</html>